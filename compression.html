<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
   <head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>HPACK - Header Compression for HTTP/2.0 </title><script>
var buttonsAdded = false;

function init() {
  var fb = document.createElement("div");
  fb.className = "feedback noprint";
  fb.setAttribute("onclick", "feedback();");
  fb.appendChild(document.createTextNode("feedback"));

  var bodyl = document.getElementsByTagName("body");
  bodyl.item(0).appendChild(fb);
}

function feedback() {
  toggleButtonsToElementsByName("h1");
  toggleButtonsToElementsByName("h2");
  toggleButtonsToElementsByName("h3");
  toggleButtonsToElementsByName("h4");

  buttonsAdded = !buttonsAdded;
}

function toggleButtonsToElementsByName(name) {
  var list = document.getElementsByTagName(name);
  for (var i = 0; i < list.length; i++) {
    toggleButton(list.item(i));
  }
}

function toggleButton(node) {
  if (! buttonsAdded) {

    // docname
    var template = "mailto:ietf-http-wg@w3.org?subject={docname},%20%22{section}%22&body=<{ref}>:";

    var id = node.getAttribute("id");
    // better id available?
    var titlelinks = node.getElementsByTagName("a");
    for (var i = 0; i < titlelinks.length; i++) {
      var tl = titlelinks.item(i);
      if (tl.getAttribute("id")) {
        id = tl.getAttribute("id");
      }
    }

    // ref
    var ref = window.location.toString();
    var hash = ref.indexOf("#");
    if (hash != -1) {
      ref = ref.substring(0, hash);
    }
    if (id != "") {
      ref += "#" + id;
    }

    // docname
    var docname = "draft-ietf-httpbis-header-compression-latest";

    // section
    var section = node.textContent;
    section = section.replace("\u00a0", " ");

    // build URI from template
    var uri = template.replace("{docname}", encodeURIComponent(docname));
    uri = uri.replace("{section}", encodeURIComponent(section));
    uri = uri.replace("{ref}", encodeURIComponent(ref));

    var button = document.createElement("a");
    button.className = "fbbutton noprint";
    button.setAttribute("href", uri);
    button.appendChild(document.createTextNode("send feedback"));
    node.appendChild(button);
  }
  else {
    var buttons = node.getElementsByTagName("a");
    for (var i = 0; i < buttons.length; i++) {
      var b = buttons.item(i);
      if (b.className == "fbbutton noprint") {
        node.removeChild(b);
      }
    }
  }
}</script><style type="text/css" title="Xml2Rfc (sans serif)">
a {
  text-decoration: none;
}
a.smpl {
  color: black;
}
a:hover {
  text-decoration: underline;
}
a:active {
  text-decoration: underline;
}
address {
  margin-top: 1em;
  margin-left: 2em;
  font-style: normal;
}
body {
  color: black;
  font-family: verdana, helvetica, arial, sans-serif;
  font-size: 10pt;
  margin-right: 2em;
}
cite {
  font-style: normal;
}
dl {
  margin-left: 2em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}
dl p {
  margin-left: 0em;
}
dt {
  margin-top: .5em;
}
h1 {
  font-size: 14pt;
  line-height: 21pt;
  page-break-after: avoid;
}
h1.np {
  page-break-before: always;
}
h1 a {
  color: #333333;
}
h2 {
  font-size: 12pt;
  line-height: 15pt;
  page-break-after: avoid;
}
h3, h4, h5, h6 {
  font-size: 10pt;
  page-break-after: avoid;
}
h2 a, h3 a, h4 a, h5 a, h6 a {
  color: black;
}
img {
  margin-left: 3em;
}
li {
  margin-left: 2em;
}
ol {
  margin-left: 2em;
}
ol.la {
  list-style-type: lower-alpha;
}
ol.ua {
  list-style-type: upper-alpha;
}
ol p {
  margin-left: 0em;
}
p {
  margin-left: 2em;
}
pre {
  margin-left: 3em;
  background-color: lightyellow;
  padding: .25em;
  page-break-inside: avoid;
}
pre.text2 {
  border-style: dotted;
  border-width: 1px;
  background-color: #f0f0f0;
  width: 69em;
}
pre.inline {
  background-color: white;
  padding: 0em;
}
pre.text {
  border-style: dotted;
  border-width: 1px;
  background-color: #f8f8f8;
  width: 69em;
}
pre.drawing {
  border-style: solid;
  border-width: 1px;
  background-color: #f8f8f8;
  padding: 2em;
}
sup {
  font-size: 60%;
}
table {
  margin-left: 2em;
}
table.tt {
  vertical-align: top;
}
table.full {
  border-style: outset;
  border-width: 1px;
}
table.headers {
  border-style: outset;
  border-width: 1px;
}
table.tt td {
  vertical-align: top;
}
table.full td {
  border-style: inset;
  border-width: 1px;
}
table.tt th {
  vertical-align: top;
}
table.full th {
  border-style: inset;
  border-width: 1px;
}
table.headers th {
  border-style: none none inset none;
  border-width: 1px;
}
table.left {
  margin-right: auto;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
caption {
  caption-side: bottom;
  font-weight: bold;
  font-size: 9pt;
  margin-top: .5em;
}

table.header {
  border-spacing: 1px;
  width: 95%;
  font-size: 10pt;
  color: white;
}
td.top {
  vertical-align: top;
}
td.topnowrap {
  vertical-align: top;
  white-space: nowrap;
}
table.header td {
  background-color: gray;
  width: 50%;
}
td.reference {
  vertical-align: top;
  white-space: nowrap;
  padding-right: 1em;
}
thead {
  display:table-header-group;
}
ul.toc, ul.toc ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
}
ul.toc li {
  line-height: 150%;
  font-weight: bold;
  font-size: 10pt;
  margin-left: 0em;
}
ul.toc li li {
  line-height: normal;
  font-weight: normal;
  font-size: 9pt;
  margin-left: 0em;
}
li.excluded {
  font-size: 0pt;
}
ul p {
  margin-left: 0em;
}

.comment {
  background-color: yellow;
}
.center {
  text-align: center;
}
.error {
  color: red;
  font-style: italic;
  font-weight: bold;
}
.figure {
  font-weight: bold;
  text-align: center;
  font-size: 9pt;
}
.filename {
  color: #333333;
  font-weight: bold;
  font-size: 12pt;
  line-height: 21pt;
  text-align: center;
}
.fn {
  font-weight: bold;
}
.hidden {
  display: none;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.title {
  color: #990000;
  font-size: 18pt;
  line-height: 18pt;
  font-weight: bold;
  text-align: center;
  margin-top: 36pt;
}
.vcardline {
  display: block;
}
.warning {
  font-size: 14pt;
  background-color: yellow;
}
.feedback {
  position: fixed;
  bottom: 1%;
  right: 1%;
  padding: 3px 5px;
  color: white;
  border-radius: 5px;
  background: #a00000;
  border: 1px solid silver;
}
.fbbutton {
  margin-left: 1em;
  color: #303030;
  font-size: small;
  font-weight: normal;
  background: #d0d000;
  padding: 1px 4px;
  border: 1px solid silver;
  border-radius: 5px;
}

@media print {
  .noprint {
    display: none;
  }

  a {
    color: black;
    text-decoration: none;
  }

  table.header {
    width: 90%;
  }

  td.header {
    width: 50%;
    color: black;
    background-color: white;
    vertical-align: top;
    font-size: 12pt;
  }

  ul.toc a:nth-child(2)::after {
    content: leader('.') target-counter(attr(href), page);
  }

  ul.ind li li a {
    content: target-counter(attr(href), page);
  }

  .print2col {
    column-count: 2;
    -moz-column-count: 2;
    column-fill: auto;
  }
}

@page {
  @top-left {
       content: "Internet-Draft";
  }
  @top-right {
       content: "September 2013";
  }
  @top-center {
       content: "HPACK";
  }
  @bottom-left {
       content: "Peon & Ruellan";
  }
  @bottom-center {
       content: "Expires March 6, 2014";
  }
  @bottom-right {
       content: "[Page " counter(page) "]";
  }
}

@page:first {
    @top-left {
      content: normal;
    }
    @top-right {
      content: normal;
    }
    @top-center {
      content: normal;
    }
}
</style><style tyle="text/css">body {   font: 11pt cambria, helvetica, arial, sans-serif;   font-size-adjust: 0.5;   line-height: 130%;   margin: 1em auto;   max-width: 700px; }  .title, .filename, h1, h2, h3, h4 {   font-family: candara, helvetica, arial, sans-serif;   font-size-adjust: 0.5; } .title { font-size: 150%; } h1 { font-size: 130%; } h2 { font-size: 120%; } h3, h4 { font-size: 110%; } ul.toc >li { font-size: 95%; } ul.toc >li >ul, .figure, caption { font-size: 90%; }  table {   margin-left: 0em; } table.header {   width: 100%; }  table.header td {   background-color: inherit;   color: black; }  samp, tt, code, pre {   font: 11pt consolas, monospace;   font-size-adjust: none; }  pre.text, pre.text2 {   width: 90%; }  dt {   float: left; clear: left;   margin: 0.5em 0.5em 0 0; } dt:first-child {   margin-top: 0; } dd {   margin: 0.5em 0 0 2em; } dd p, dd ul {   margin-top: 0; margin-bottom: 0; } dd *+p {   margin-top: 0.5em; }  ol, ul {   padding: 0;   margin: 0.5em 0 0.5em 2em; } ul.toc, ul.toc ul {    margin: 0 0 0 1.5em; } ul.toc a:first-child {    display: inline-block;    min-width: 1.2em; }</style><link rel="Contents" href="#rfc.toc">
      <link rel="Author" href="#rfc.authors">
      <link rel="Copyright" href="#rfc.copyrightnotice">
      <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
      <link rel="Chapter" title="2 Overview" href="#rfc.section.2">
      <link rel="Chapter" title="3 Header Encoding" href="#rfc.section.3">
      <link rel="Chapter" title="4 Detailed Format" href="#rfc.section.4">
      <link rel="Chapter" title="5 Parameter Negotiation" href="#rfc.section.5">
      <link rel="Chapter" title="6 Security Considerations" href="#rfc.section.6">
      <link rel="Chapter" title="7 IANA Considerations" href="#rfc.section.7">
      <link rel="Chapter" href="#rfc.section.8" title="8 References">
      <link rel="Appendix" title="A Change Log (to be removed by RFC Editor before publication" href="#rfc.section.A">
      <link rel="Appendix" title="B Initial Header Tables" href="#rfc.section.B">
      <link rel="Appendix" title="C Example" href="#rfc.section.C">
      <meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.598, 2013/06/23 14:11:10, XSLT vendor: SAXON 9.1.0.8 from Saxonica http://www.saxonica.com/">
      <meta name="keywords" content="HTTP, Header">
      <link rel="schema.dct" href="http://purl.org/dc/terms/">
      <meta name="dct.creator" content="Peon, R.">
      <meta name="dct.creator" content="Ruellan, H.">
      <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-httpbis-header-compression-latest">
      <meta name="dct.issued" scheme="ISO8601" content="2013-09-02">
      <meta name="dct.abstract" content="This document describes HPACK, a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.">
      <meta name="description" content="This document describes HPACK, a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.">
   </head>
   <body onload="init();">
      <table class="header">
         <tbody>
            <tr>
               <td class="left">HTTPbis Working Group</td>
               <td class="right">R. Peon</td>
            </tr>
            <tr>
               <td class="left">Internet-Draft</td>
               <td class="right">Google, Inc</td>
            </tr>
            <tr>
               <td class="left">Intended status: Informational</td>
               <td class="right">H. Ruellan</td>
            </tr>
            <tr>
               <td class="left">Expires: March 6, 2014</td>
               <td class="right">Canon CRF</td>
            </tr>
            <tr>
               <td class="left"></td>
               <td class="right">September 2, 2013</td>
            </tr>
         </tbody>
      </table>
      <p class="title">HPACK - Header Compression for HTTP/2.0<br><span class="filename">draft-ietf-httpbis-header-compression-latest</span></p>
      <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
      <p>This document describes HPACK, a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.</p>
      <h1 id="rfc.note.1"><a href="#rfc.note.1">Editorial Note (To be removed by RFC Editor)</a></h1>
      <p>Discussion of this draft takes place on the HTTPBIS working group mailing list (ietf-http-wg@w3.org), which is archived at &lt;<a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">http://lists.w3.org/Archives/Public/ietf-http-wg/</a>&gt;.
      </p>
      <p>Working Group information and related documents can be found at &lt;<a href="http://tools.ietf.org/wg/httpbis/">http://tools.ietf.org/wg/httpbis/</a>&gt; (Wiki) and &lt;<a href="https://github.com/http2/http2-spec">https://github.com/http2/http2-spec</a>&gt; (source code and issues tracker).
      </p>
      <p>The changes in this draft are summarized in <a href="#changes.since.draft-ietf-httpbis-header-compression-03" title="Since draft-ietf-httpbis-header-compression-03">Appendix&nbsp;A.1</a>.
      </p>
      <h1><a id="rfc.status" href="#rfc.status">Status of This Memo</a></h1>
      <p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
      <p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute
         working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.
      </p>
      <p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other
         documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work
         in progress”.
      </p>
      <p>This Internet-Draft will expire on March 6, 2014.</p>
      <h1><a id="rfc.copyrightnotice" href="#rfc.copyrightnotice">Copyright Notice</a></h1>
      <p>Copyright © 2013 IETF Trust and the persons identified as the document authors. All rights reserved.</p>
      <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights
         and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License
         text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified
         BSD License.
      </p>
      <hr class="noprint">
      <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
      <ul class="toc">
         <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.1">Introduction</a></li>
         <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#overview">Overview</a><ul>
               <li><a href="#rfc.section.2.1">2.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.2.1">Outline</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#header.encoding">Header Encoding</a><ul>
               <li><a href="#rfc.section.3.1">3.1</a>&nbsp;&nbsp;&nbsp;<a href="#encoding.concepts">Encoding Concepts</a><ul>
                     <li><a href="#rfc.section.3.1.1">3.1.1</a>&nbsp;&nbsp;&nbsp;<a href="#encoding.context">Encoding Context</a></li>
                     <li><a href="#rfc.section.3.1.2">3.1.2</a>&nbsp;&nbsp;&nbsp;<a href="#header.table">Header Table</a></li>
                     <li><a href="#rfc.section.3.1.3">3.1.3</a>&nbsp;&nbsp;&nbsp;<a href="#reference.set">Reference Set</a></li>
                     <li><a href="#rfc.section.3.1.4">3.1.4</a>&nbsp;&nbsp;&nbsp;<a href="#header.set">Header set</a></li>
                     <li><a href="#rfc.section.3.1.5">3.1.5</a>&nbsp;&nbsp;&nbsp;<a href="#header.representation">Header Representation</a></li>
                     <li><a href="#rfc.section.3.1.6">3.1.6</a>&nbsp;&nbsp;&nbsp;<a href="#header.emission">Header Emission</a></li>
                  </ul>
               </li>
               <li><a href="#rfc.section.3.2">3.2</a>&nbsp;&nbsp;&nbsp;<a href="#header.set.processing">Header Set Processing</a><ul>
                     <li><a href="#rfc.section.3.2.1">3.2.1</a>&nbsp;&nbsp;&nbsp;<a href="#header.representation.processing">Header Representation Processing</a></li>
                     <li><a href="#rfc.section.3.2.2">3.2.2</a>&nbsp;&nbsp;&nbsp;<a href="#reference.set.emission">Reference Set Emission</a></li>
                     <li><a href="#rfc.section.3.2.3">3.2.3</a>&nbsp;&nbsp;&nbsp;<a href="#header.set.completion">Header Set Completion</a></li>
                     <li><a href="#rfc.section.3.2.4">3.2.4</a>&nbsp;&nbsp;&nbsp;<a href="#header.table.management">Header Table Management</a></li>
                  </ul>
               </li>
            </ul>
         </li>
         <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#detailed.format">Detailed Format</a><ul>
               <li><a href="#rfc.section.4.1">4.1</a>&nbsp;&nbsp;&nbsp;<a href="#string.encoding">Low-level representations</a><ul>
                     <li><a href="#rfc.section.4.1.1">4.1.1</a>&nbsp;&nbsp;&nbsp;<a href="#integer.representation">Integer representation</a><ul>
                           <li><a href="#rfc.section.4.1.1.1">4.1.1.1</a>&nbsp;&nbsp;&nbsp;<a href="#integer.representation.example1">Example 1: Encoding 10 using a 5-bit prefix</a></li>
                           <li><a href="#rfc.section.4.1.1.2">4.1.1.2</a>&nbsp;&nbsp;&nbsp;<a href="#integer.representation.example2">Example 2: Encoding 1337 using a 5-bit prefix</a></li>
                        </ul>
                     </li>
                     <li><a href="#rfc.section.4.1.2">4.1.2</a>&nbsp;&nbsp;&nbsp;<a href="#header.name.representation">Header Name Representation</a></li>
                     <li><a href="#rfc.section.4.1.3">4.1.3</a>&nbsp;&nbsp;&nbsp;<a href="#string.literal.representation">Header Value Representation</a></li>
                  </ul>
               </li>
               <li><a href="#rfc.section.4.2">4.2</a>&nbsp;&nbsp;&nbsp;<a href="#indexed.header.representation">Indexed Header Representation</a></li>
               <li><a href="#rfc.section.4.3">4.3</a>&nbsp;&nbsp;&nbsp;<a href="#literal.header.representation">Literal Header Representation</a><ul>
                     <li><a href="#rfc.section.4.3.1">4.3.1</a>&nbsp;&nbsp;&nbsp;<a href="#literal.header.without.indexing">Literal Header without Indexing</a></li>
                     <li><a href="#rfc.section.4.3.2">4.3.2</a>&nbsp;&nbsp;&nbsp;<a href="#literal.header.with.incremental.indexing">Literal Header with Incremental Indexing</a></li>
                     <li><a href="#rfc.section.4.3.3">4.3.3</a>&nbsp;&nbsp;&nbsp;<a href="#literal.header.with.substitution.indexing">Literal Header with Substitution Indexing</a></li>
                  </ul>
               </li>
            </ul>
         </li>
         <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter.negotiation">Parameter Negotiation</a></li>
         <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#Security">Security Considerations</a></li>
         <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#IANA">IANA Considerations</a></li>
         <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a><ul>
               <li><a href="#rfc.section.8.1">8.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.1">Normative References</a></li>
               <li><a href="#rfc.section.8.2">8.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.2">Informative References</a></li>
            </ul>
         </li>
         <li><a href="#rfc.authors">Authors' Addresses</a></li>
         <li><a href="#rfc.section.A">A.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.A">Change Log (to be removed by RFC Editor before publication</a><ul>
               <li><a href="#rfc.section.A.1">A.1</a>&nbsp;&nbsp;&nbsp;<a href="#changes.since.draft-ietf-httpbis-header-compression-03">Since draft-ietf-httpbis-header-compression-03</a></li>
               <li><a href="#rfc.section.A.2">A.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.A.2">Since draft-ietf-httpbis-header-compression-02</a></li>
               <li><a href="#rfc.section.A.3">A.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.A.3">Since draft-ietf-httpbis-header-compression-01</a></li>
               <li><a href="#rfc.section.A.4">A.4</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.A.4">Since draft-ietf-httpbis-header-compression-01</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.B">B.</a>&nbsp;&nbsp;&nbsp;<a href="#initial.headers">Initial Header Tables</a><ul>
               <li><a href="#rfc.section.B.1">B.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.B.1">Requests</a></li>
               <li><a href="#rfc.section.B.2">B.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.B.2">Responses</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.C">C.</a>&nbsp;&nbsp;&nbsp;<a href="#example">Example</a><ul>
               <li><a href="#rfc.section.C.1">C.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.C.1">First header set</a></li>
               <li><a href="#rfc.section.C.2">C.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.C.2">Second header set</a></li>
            </ul>
         </li>
      </ul>
      <ul class="toc">
         <li>Figures
            
            <ul>
               <li><a href="#rfc.figure.1">Figure 1: Indexed Header</a></li>
               <li><a href="#rfc.figure.2">Figure 2: Literal Header without Indexing - Indexed Name</a></li>
               <li><a href="#rfc.figure.3">Figure 3: Literal Header without Indexing - New Name</a></li>
               <li><a href="#rfc.figure.4">Figure 4: Literal Header with Incremental Indexing -                         Indexed Name</a></li>
               <li><a href="#rfc.figure.5">Figure 5: Literal Header with Incremental Indexing -                         New Name</a></li>
               <li><a href="#rfc.figure.6">Figure 6: Literal Header with Substitution Indexing -                         Indexed Name</a></li>
               <li><a href="#rfc.figure.7">Figure 7: Literal Header with Substitution Indexing -                         New Name</a></li>
            </ul>
         </li>
      </ul>
      <h1 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;Introduction
      </h1>
      <p id="rfc.section.1.p.1">This document describes HPACK, a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.</p>
      <h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a id="overview" href="#overview">Overview</a></h1>
      <p id="rfc.section.2.p.1">In HTTP/1.X, headers are sent without any form of compression. As web pages have grown to include dozens to hundreds of requests,
         the redundant headers in these requests now pose a problem of measurable latency and unnecessary bandwidth (see <a href="#PERF1"><cite title="IETF83: SPDY and What to Consider for HTTP/2.0">[PERF1]</cite></a> and <a href="#PERF2"><cite title="SPDY: What I Like About You">[PERF2]</cite></a>).
      </p>
      <p id="rfc.section.2.p.2"><a href="#SPDY">SPDY</a> <cite title="SPDY Protocol">[SPDY]</cite> initially addressed this redundancy by compressing headers with Deflate, which proved very effective at eliminating the redundant
         headers. However, that aproach exposed a security risk as demonstrated by the <a href="#CRIME">CRIME</a> <cite title="The Crime Attack">[CRIME]</cite>.
      </p>
      <p id="rfc.section.2.p.3">In this document, we propose a new header compressor which eliminates the redundant headers, is not vulnerable to the CRIME
         style attack, and which also has a bounded memory cost for use in small constrained environments.
      </p>
      <h2 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a>&nbsp;Outline
      </h2>
      <p id="rfc.section.2.1.p.1">The HTTP header encoding described in this document is based on a header table that map (name, value) pairs to index values.
         Header tables are incrementally updated during the HTTP/2.0 session.
      </p>
      <p id="rfc.section.2.1.p.2">The encoder is responsible for deciding which headers to insert as new entries in the header table. The decoder then does
         exactly what the encoder prescribes, ending in a state that exactly matches the encoder's state. This enables decoders to
         remain simple and understand a wide variety of encoders.
      </p>
      <p id="rfc.section.2.1.p.3">As two consecutive sets of headers often have headers in common, each set of headers is coded as a difference from the previous
         set of headers. The goal is to only encode the changes (headers present in one of the set and not in the other) between the
         two sets of headers.
      </p>
      <p id="rfc.section.2.1.p.4">An example illustrating the use of these different mechanisms to represent headers is available in <a href="#example" title="Example">Appendix&nbsp;C</a>.
      </p>
      <h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a id="header.encoding" href="#header.encoding">Header Encoding</a></h1>
      <h2 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1</a>&nbsp;<a id="encoding.concepts" href="#encoding.concepts">Encoding Concepts</a></h2>
      <p id="rfc.section.3.1.p.1">The encoding and decoding of headers relies on some components and concepts. The set of components used form an encoding context. </p>
      <dl>
         <dt>Header Table:</dt>
         <dd>The header table (see <a href="#header.table" title="Header Table">Section&nbsp;3.1.2</a>) is a component used to associate headers to index values.
         </dd>
         <dt>Reference Set:</dt>
         <dd>The reference set (see <a href="#reference.set" title="Reference Set">Section&nbsp;3.1.3</a>) is a component containing a group of headers used as a reference for the differential encoding of a new set of headers.
         </dd>
         <dt>Header Set:</dt>
         <dd>A header set (see <a href="#header.set" title="Header set">Section&nbsp;3.1.4</a>) is a group of headers that are encoded jointly. A complete set of key-value pairs as encoded in an HTTP request or response
            is a header set.
         </dd>
         <dt>Header Representation:</dt>
         <dd>A header can be represented in encoded form either as a literal or as an index (see <a href="#header.representation" title="Header Representation">Section&nbsp;3.1.5</a>). The indexed representation is based on the header table.
         </dd>
         <dt>Header Emission:</dt>
         <dd>When decoding a set of headers, some operations emit a header (see <a href="#header.emission" title="Header Emission">Section&nbsp;3.1.6</a>). An emitted header is added to the set of headers that form the HTTP request or response. Once emitted, a header can't be
            removed from the set of headers.
         </dd>
      </dl>
      <h3 id="rfc.section.3.1.1"><a href="#rfc.section.3.1.1">3.1.1</a>&nbsp;<a id="encoding.context" href="#encoding.context">Encoding Context</a></h3>
      <p id="rfc.section.3.1.1.p.1">The set of components used to encode or decode a header set form an encoding context: an encoding context contains a header
         table and a reference set.
      </p>
      <p id="rfc.section.3.1.1.p.2">Using HTTP, messages are exchanged between a client and a server in both direction. To keep the encoding of headers in each
         direction independent from the other direction, there is one encoding context for each direction.
      </p>
      <p id="rfc.section.3.1.1.p.3">The headers contained in a PUSH_PROMISE frame sent by a server to a client are encoded within the same context as the headers
         contained in the HEADERS frame corresponding to a response sent from the server to the client.
      </p>
      <h3 id="rfc.section.3.1.2"><a href="#rfc.section.3.1.2">3.1.2</a>&nbsp;<a id="header.table" href="#header.table">Header Table</a></h3>
      <p id="rfc.section.3.1.2.p.1">A header table consists of an ordered list of (name, value) pairs. The first entry of a header table is assigned the index
         0.
      </p>
      <p id="rfc.section.3.1.2.p.2">A header can be represented by an entry from the header table. Rather than encoding a literal value for the header field name
         and value, the encoder can select an entry from the header table.
      </p>
      <p id="rfc.section.3.1.2.p.3">Literal header names MUST be translated to lowercase before encoding and transmission. This enables an encoder to perform
         direct bitwise comparisons on names and values when determining if an entry already exists in the header table.
      </p>
      <p id="rfc.section.3.1.2.p.4">There is no need for the header table to contain duplicate entries. However, duplicate entries MUST NOT be treated as an error
         by a decoder.
      </p>
      <p id="rfc.section.3.1.2.p.5">Initially, a header table contains a list of common headers. Two initial lists of header are provided in <a href="#initial.headers" title="Initial Header Tables">Appendix&nbsp;B</a>. One list is for headers transmitted from a client to a server, the other for the reverse direction.
      </p>
      <p id="rfc.section.3.1.2.p.6">A header table is modified by either adding a new entry at the end of the table, or by replacing an existing entry.</p>
      <p id="rfc.section.3.1.2.p.7">The encoder decides how to update the header table and as such can control how much memory is used by the header table. To
         limit the memory requirements on the decoder side, the header table size is bounded (see the SETTINGS_HEADER_TABLE_SIZE in <a href="#parameter.negotiation" title="Parameter Negotiation">Section&nbsp;5</a>).
      </p>
      <p id="rfc.section.3.1.2.p.8">The size of an entry is the sum of its name's length in bytes (as defined in <a href="#header.name.representation" title="Header Name Representation">Section&nbsp;4.1.2</a>), of its value's length in bytes (<a href="#string.literal.representation" title="Header Value Representation">Section&nbsp;4.1.3</a>) and of 32 bytes. The 32 bytes are an accounting for the entry structure overhead. For example, an entry structure using
         two 64-bits pointers to reference the name and the value and the entry, and two 64-bits integer for counting the number of
         references to these name and value would use 32 bytes.
      </p>
      <p id="rfc.section.3.1.2.p.9">The size of a header table is the sum of the size of its entries.</p>
      <h3 id="rfc.section.3.1.3"><a href="#rfc.section.3.1.3">3.1.3</a>&nbsp;<a id="reference.set" href="#reference.set">Reference Set</a></h3>
      <p id="rfc.section.3.1.3.p.1">A reference set is defined as an unordered set of references to entries of the header table.</p>
      <p id="rfc.section.3.1.3.p.2">The initial reference set is the empty set.</p>
      <p id="rfc.section.3.1.3.p.3">The reference set is updated during the processing of a set of headers.</p>
      <p id="rfc.section.3.1.3.p.4">Using the differential encoding, a header that is not present in the reference set can be encoded either with an indexed representation
         (if the header is present in the header table), or with a literal representation (if the header is not present in the header
         table).
      </p>
      <p id="rfc.section.3.1.3.p.5">A header that is to be removed from the reference set is encoded with an indexed representation.</p>
      <h3 id="rfc.section.3.1.4"><a href="#rfc.section.3.1.4">3.1.4</a>&nbsp;<a id="header.set" href="#header.set">Header set</a></h3>
      <p id="rfc.section.3.1.4.p.1">A header set is a group of header fields that are encoded as a whole. Each header field is a (name, value) pair.</p>
      <p id="rfc.section.3.1.4.p.2">A header set is encoded using an ordered list of zero or more header representations. All the header representations describing
         a header set a grouped into a header block.
      </p>
      <h3 id="rfc.section.3.1.5"><a href="#rfc.section.3.1.5">3.1.5</a>&nbsp;<a id="header.representation" href="#header.representation">Header Representation</a></h3>
      <p id="rfc.section.3.1.5.p.1">A header can be represented either as a literal or as an index.</p>
      <p id="rfc.section.3.1.5.p.2"></p>
      <dl>
         <dt>Literal Representation:</dt>
         <dd>A literal representation defines a new header. The header name is represented either literally or as a reference to an entry
            of the header table. The header value is represented literally.
         </dd>
         <dd>Three different literal representations are provided: 
            <ul>
               <li>A literal representation that does not add the header to the header table (see <a href="#literal.header.without.indexing" title="Literal Header without Indexing">Section&nbsp;4.3.1</a>).
               </li>
               <li>A literal representation that adds the header at the end of the header table (see <a href="#literal.header.with.incremental.indexing" title="Literal Header with Incremental Indexing">Section&nbsp;4.3.2</a>).
               </li>
               <li>A literal representation that uses the header to replace an existing entry of the header table (see <a href="#literal.header.with.substitution.indexing" title="Literal Header with Substitution Indexing">Section&nbsp;4.3.3</a>).
               </li>
            </ul> 
         </dd>
         <dt>Indexed Representation:</dt>
         <dd>The indexed representation defines a header as a reference in the header table (see <a href="#indexed.header.representation" title="Indexed Header Representation">Section&nbsp;4.2</a>).
         </dd>
      </dl>
      <h3 id="rfc.section.3.1.6"><a href="#rfc.section.3.1.6">3.1.6</a>&nbsp;<a id="header.emission" href="#header.emission">Header Emission</a></h3>
      <p id="rfc.section.3.1.6.p.1">The emission of header is the process of adding a header to the current set of headers. Once an header is emitted, it can't
         be removed from the current set of headers.
      </p>
      <p id="rfc.section.3.1.6.p.2">The concept of header emission allows a decoder to know when it can pass a header safely to a higher level on the receiver
         side. This allows a decoder to be implemented in a streaming way, and as such to only keep in memory the header table and
         the reference set. With such an implementation, the amount of memory used by the decoder is bounded, even in presence of a
         very large set of headers. The management of memory for handling very large sets of headers can therefore be deferred to the
         application, which may be able to emit the header to the wire and thus free up memory quickly.
      </p>
      <h2 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2</a>&nbsp;<a id="header.set.processing" href="#header.set.processing">Header Set Processing</a></h2>
      <p id="rfc.section.3.2.p.1">The processing of an encoded header set to obtain a list of headers is defined in this section. To ensure a correct decoding
         of a header set, a decoder MUST obey the following rules.
      </p>
      <h3 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1</a>&nbsp;<a id="header.representation.processing" href="#header.representation.processing">Header Representation Processing</a></h3>
      <p id="rfc.section.3.2.1.p.1">All the header representations contained in a header block are processed in the order in which they are presented, as specified
         below.
      </p>
      <p id="rfc.section.3.2.1.p.2">An <em>indexed representation</em> corresponding to an entry <em>not present</em> in the reference set entails the following actions: 
      </p>
      <ul>
         <li>The header corresponding to the entry is emitted.</li>
         <li>The entry is added to the reference set.</li>
      </ul>
      <p id="rfc.section.3.2.1.p.3">An <em>indexed representation</em> corresponding to an entry <em>present</em> in the reference set entails the following actions: 
      </p>
      <ul>
         <li>The entry is removed from the reference set.</li>
      </ul>
      <p id="rfc.section.3.2.1.p.4">A <em>literal representation</em> that is <em>not added</em> to the header table entails the following action: 
      </p>
      <ul>
         <li>The header is emitted.</li>
      </ul>
      <p id="rfc.section.3.2.1.p.5">A <em>literal representation</em> that is <em>added</em> to the header table entails the following actions: 
      </p>
      <ul>
         <li>The header is emitted.</li>
         <li>The header is added to the header table, at the location defined by the representation.</li>
         <li>The new entry is added to the reference set.</li>
      </ul>
      <h3 id="rfc.section.3.2.2"><a href="#rfc.section.3.2.2">3.2.2</a>&nbsp;<a id="reference.set.emission" href="#reference.set.emission">Reference Set Emission</a></h3>
      <p id="rfc.section.3.2.2.p.1">Once all the representations contained in a header block have been processed, the headers that are in common with the previous
         header set are emitted, during the reference set emission.
      </p>
      <p id="rfc.section.3.2.2.p.2">For the reference set emission, each header contained in the reference set that has not been emitted during the processing
         of the header block is emitted.
      </p>
      <h3 id="rfc.section.3.2.3"><a href="#rfc.section.3.2.3">3.2.3</a>&nbsp;<a id="header.set.completion" href="#header.set.completion">Header Set Completion</a></h3>
      <p id="rfc.section.3.2.3.p.1">Once all of the header representations have been processed, and the remaining items in the reference set have been emitted,
         the header set is complete.
      </p>
      <h3 id="rfc.section.3.2.4"><a href="#rfc.section.3.2.4">3.2.4</a>&nbsp;<a id="header.table.management" href="#header.table.management">Header Table Management</a></h3>
      <p id="rfc.section.3.2.4.p.1">The header table can be modified by either adding a new entry to it or by replacing an existing one. Before doing such a modification,
         it has to be ensured that the header table size will stay lower than or equal to the SETTINGS_HEADER_TABLE_SIZE limit (see <a href="#parameter.negotiation" title="Parameter Negotiation">Section&nbsp;5</a>). To achieve this, repeatedly, the first entry of the header table is removed, until enough space is available for the modification.
      </p>
      <p id="rfc.section.3.2.4.p.2">A consequence of removing one or more entries at the beginning of the header table is that the remaining entries are renumbered.
         The first entry of the header table is always associated to the index 0.
      </p>
      <p id="rfc.section.3.2.4.p.3">When the modification of the header table is the replacement of an existing entry, the replaced entry is the one indicated
         in the literal representation before any entry is removed from the header table. If the entry to be replaced is removed from
         the header table when performing the size adjustment, the replacement entry is inserted at the beginning of the header table.
      </p>
      <p id="rfc.section.3.2.4.p.4">The addition of a new entry with a size greater than the SETTINGS_HEADER_TABLE_SIZE limit causes all the entries from the
         header table to be dropped and the new entry not to be added to the header table. The replacement of an existing entry with
         a new entry with a size greater than the SETTINGS_HEADER_TABLE_SIZE has the same consequences.
      </p>
      <h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a id="detailed.format" href="#detailed.format">Detailed Format</a></h1>
      <h2 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1</a>&nbsp;<a id="string.encoding" href="#string.encoding">Low-level representations</a></h2>
      <h3 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1</a>&nbsp;<a id="integer.representation" href="#integer.representation">Integer representation</a></h3>
      <p id="rfc.section.4.1.1.p.1">Integers are used to represent name indexes, pair indexes or string lengths. To allow for optimized processing, an integer
         representation always finishes at the end of a byte.
      </p>
      <p id="rfc.section.4.1.1.p.2">An integer is represented in two parts: a prefix that fills the current byte and an optional list of bytes that are used if
         the integer value does not fit in the prefix. The number of bits of the prefix (called N) is a parameter of the integer representation.
      </p>
      <p id="rfc.section.4.1.1.p.3">The N-bit prefix allows filling the current byte. If the value is small enough (strictly less than 2<sup>N</sup>-1), it is encoded within the N-bit prefix. Otherwise all the bits of the prefix are set to 1 and the value is encoded using
         an <a href="http://en.wikipedia.org/wiki/Variable-length_quantity">unsigned variable length integer</a> representation.
      </p>
      <p id="rfc.section.4.1.1.p.4">The algorithm to represent an integer I is as follows: </p>
      <div id="rfc.figure.u.1"></div><pre class="inline">If I &lt; 2^N - 1, encode I on N bits
Else
    encode 2^N - 1 on N bits
    I = I - (2^N - 1)
    While I &gt;= 128
         Encode (I % 128 + 128) on 8 bits
         I = I / 128
    encode (I) on 8 bits
                        </pre><h4 id="rfc.section.4.1.1.1"><a href="#rfc.section.4.1.1.1">4.1.1.1</a>&nbsp;<a id="integer.representation.example1" href="#integer.representation.example1">Example 1: Encoding 10 using a 5-bit prefix</a></h4>
      <p id="rfc.section.4.1.1.1.p.1">The value 10 is to be encoded with a 5-bit prefix. </p>
      <ul>
         <li>10 is less than 31 (= 2<sup>5</sup> - 1) and is represented using the 5-bit prefix.
         </li>
      </ul>
      <div id="rfc.figure.u.2"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X | X | X | 0 | 1 | 0 | 1 | 0 |   10 stored on 5 bits
+---+---+---+---+---+---+---+---+
</pre><h4 id="rfc.section.4.1.1.2"><a href="#rfc.section.4.1.1.2">4.1.1.2</a>&nbsp;<a id="integer.representation.example2" href="#integer.representation.example2">Example 2: Encoding 1337 using a 5-bit prefix</a></h4>
      <p id="rfc.section.4.1.1.2.p.1">The value I=1337 is to be encoded with a 5-bit prefix. </p>
      <ul class="empty">
         <li>1337 is greater than 31 (= 2<sup>5</sup> - 1).
         </li>
         <li>
            <ul class="empty">
               <li>The 5-bit prefix is filled with its max value (31).</li>
            </ul> 
         </li>
         <li>I = 1337 - (2<sup>5</sup> - 1) = 1306.
         </li>
         <li>
            <ul class="empty">
               <li>I (1306) is greater than or equal to 128, the while loop body executes:</li>
               <li>
                  <ul class="empty">
                     <li>I % 128 == 26</li>
                     <li>26 + 128 == 154</li>
                     <li>154 is encoded in 8 bits as: 10011010</li>
                     <li>I is set to 10 (1306 / 128 == 10)</li>
                     <li>I is no longer greater than or equal to 128, the while loop terminates.</li>
                  </ul> 
               </li>
               <li>I, now 10, is encoded on 8 bits as: 00001010</li>
            </ul> 
         </li>
         <li>The process ends.</li>
      </ul>
      <div id="rfc.figure.u.3"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X | X | X | 1 | 1 | 1 | 1 | 1 |  Prefix = 31, I = 1306
| 1 | 0 | 0 | 1 | 1 | 0 | 1 | 0 |  1306&gt;=128, encode(154), I=1306/128
| 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |  10&lt;128, encode(10), done
+---+---+---+---+---+---+---+---+
</pre><h3 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2</a>&nbsp;<a id="header.name.representation" href="#header.name.representation">Header Name Representation</a></h3>
      <p id="rfc.section.4.1.2.p.1">Header names are sequences of ASCII characters that MUST conform to the following header-name ABNF construction:</p>
      <div id="rfc.figure.u.4"></div><pre class="inline">  LOWERALPHA = %x61-7A
  header-char = "!" / "#" / "$" / "%" / "&amp;" / "'" /
                "*" / "+" / "-" / "." / "^" / "_" /
                "`" / "|" / "~" / DIGIT / LOWERALPHA
  header-name = [":"] 1*header-char
                  </pre><p id="rfc.section.4.1.2.p.3">They are encoded in two parts: </p>
      <ol>
         <li>The length of the text, defined as the number of octets of storage required to store the text, represented as a variable-length-quantity (<a href="#integer.representation" title="Integer representation">Section&nbsp;4.1.1</a>).
         </li>
         <li>The specific sequence of ASCII octets</li>
      </ol>
      <h3 id="rfc.section.4.1.3"><a href="#rfc.section.4.1.3">4.1.3</a>&nbsp;<a id="string.literal.representation" href="#string.literal.representation">Header Value Representation</a></h3>
      <p id="rfc.section.4.1.3.p.1">Header values are encoded as sequences of UTF-8 encoded text. They are encoded in two parts: </p>
      <ol>
         <li>The length of the text, defined as the number of octets of storage required to store the text, represented as a variable-length-quantity (<a href="#integer.representation" title="Integer representation">Section&nbsp;4.1.1</a>).
         </li>
         <li>The specific sequence of octets representing the UTF-8 text.</li>
      </ol>
      <p id="rfc.section.4.1.3.p.2">Invalid UTF-8 octet sequences, "over-long" UTF-8 encodings, and UTF-8 octets that represent invalid Unicode Codepoints MUST
         NOT be used.
      </p>
      <h2 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2</a>&nbsp;<a id="indexed.header.representation" href="#indexed.header.representation">Indexed Header Representation</a></h2>
      <p id="rfc.section.4.2.p.1">An indexed header representation identifies an entry in the header table. The entry is emitted and added to the reference
         set if it is not currently in the reference set. The entry is removed from the reference set if it is present in the reference
         set.
      </p>
      <div id="rfc.figure.1"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 1 |        Index (7+)         |
+---+---------------------------+
</pre><p class="figure">Figure 1: Indexed Header</p>
      <p id="rfc.section.4.2.p.3">This representation starts with the '1' 1-bit pattern, followed by the index of the matching pair, represented as an integer
         with a 7-bit prefix.
      </p>
      <h2 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3</a>&nbsp;<a id="literal.header.representation" href="#literal.header.representation">Literal Header Representation</a></h2>
      <p id="rfc.section.4.3.p.1">Literal header representations contain a literal header field value. Header field names are either provided as a literal or
         by reference to an existing header table entry.
      </p>
      <p id="rfc.section.4.3.p.2">Literal representations all result in the emission of a header when decoded.</p>
      <h3 id="rfc.section.4.3.1"><a href="#rfc.section.4.3.1">4.3.1</a>&nbsp;<a id="literal.header.without.indexing" href="#literal.header.without.indexing">Literal Header without Indexing</a></h3>
      <p id="rfc.section.4.3.1.p.1">An literal header without indexing causes the emission of a header without altering the header table.</p>
      <div id="rfc.figure.2"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 1 |    Index (5+)     |
+---+---+---+-------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre><p class="figure">Figure 2: Literal Header without Indexing - Indexed Name</p>
      <div id="rfc.figure.3"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 1 |         0         |
+---+---+---+-------------------+
|       Name Length (8+)        |
+-------------------------------+
|  Name String (Length octets)  |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre><p class="figure">Figure 3: Literal Header without Indexing - New Name</p>
      <p id="rfc.section.4.3.1.p.4">This representation starts with the '011' 3-bit pattern.</p>
      <p id="rfc.section.4.3.1.p.5">If the header name matches the header name of a (name, value) pair stored in the Header Table, the index of the pair increased
         by one (index + 1) is represented as an integer with a 5-bit prefix. Note that if the index is strictly below 31, one byte
         is used.
      </p>
      <p id="rfc.section.4.3.1.p.6">If the header name does not match a header name entry, the value 0 is represented on 5 bits followed by the header name (<a href="#header.name.representation" title="Header Name Representation">Section&nbsp;4.1.2</a>).
      </p>
      <p id="rfc.section.4.3.1.p.7">Header name representation is followed by the header value represented as a literal string as described in <a href="#string.literal.representation" title="Header Value Representation">Section&nbsp;4.1.3</a>.
      </p>
      <h3 id="rfc.section.4.3.2"><a href="#rfc.section.4.3.2">4.3.2</a>&nbsp;<a id="literal.header.with.incremental.indexing" href="#literal.header.with.incremental.indexing">Literal Header with Incremental Indexing</a></h3>
      <p id="rfc.section.4.3.2.p.1">A literal header with incremental indexing adds a new entry to the header table.</p>
      <div id="rfc.figure.4"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 0 |    Index (5+)     |
+---+---+---+-------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre><p class="figure">Figure 4: Literal Header with Incremental Indexing -                         Indexed Name</p>
      <div id="rfc.figure.5"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 0 |         0         |
+---+---+---+-------------------+
|       Name Length (8+)        |
+-------------------------------+
|  Name String (Length octets)  |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre><p class="figure">Figure 5: Literal Header with Incremental Indexing -                         New Name</p>
      <p id="rfc.section.4.3.2.p.4">This representation starts with the '010' 3-bit pattern.</p>
      <p id="rfc.section.4.3.2.p.5">If the header name matches the header name of a (name, value) pair stored in the Header Table, the index of the pair increased
         by one (index + 1) is represented as an integer with a 5-bit prefix. Note that if the index is strictly below 31, one byte
         is used.
      </p>
      <p id="rfc.section.4.3.2.p.6">If the header name does not match a header name entry, the value 0 is represented on 5 bits followed by the header name (<a href="#header.name.representation" title="Header Name Representation">Section&nbsp;4.1.2</a>).
      </p>
      <p id="rfc.section.4.3.2.p.7">Header name representation is followed by the header value represented as a literal string as described in <a href="#string.literal.representation" title="Header Value Representation">Section&nbsp;4.1.3</a>.
      </p>
      <h3 id="rfc.section.4.3.3"><a href="#rfc.section.4.3.3">4.3.3</a>&nbsp;<a id="literal.header.with.substitution.indexing" href="#literal.header.with.substitution.indexing">Literal Header with Substitution Indexing</a></h3>
      <p id="rfc.section.4.3.3.p.1">A literal header with substitution indexing replaces an existing header table entry.</p>
      <div id="rfc.figure.6"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 |      Index (6+)       |
+---+---+-----------------------+
|    Substituted Index (8+)     |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre><p class="figure">Figure 6: Literal Header with Substitution Indexing -                         Indexed Name</p>
      <div id="rfc.figure.7"></div><pre class="inline">  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 |           0           |
+---+---+-----------------------+
|       Name Length (8+)        |
+-------------------------------+
|  Name String (Length octets)  |
+-------------------------------+
|    Substituted Index (8+)     |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre><p class="figure">Figure 7: Literal Header with Substitution Indexing -                         New Name</p>
      <p id="rfc.section.4.3.3.p.4">This representation starts with the '00' 2-bit pattern.</p>
      <p id="rfc.section.4.3.3.p.5">If the header name matches the header name of a (name, value) pair stored in the Header Table, the index of the pair increased
         by one (index + 1) is represented as an integer with a 6-bit prefix. Note that if the index is strictly below 63, one byte
         is used.
      </p>
      <p id="rfc.section.4.3.3.p.6">If the header name does not match a header name entry, the value 0 is represented on 6 bits followed by the header name (<a href="#header.name.representation" title="Header Name Representation">Section&nbsp;4.1.2</a>).
      </p>
      <p id="rfc.section.4.3.3.p.7">The index of the substituted (name, value) pair is inserted after the header name representation as a 0-bit prefix integer.</p>
      <p id="rfc.section.4.3.3.p.8">The index of the substituted pair MUST correspond to a position in the header table containing a non-void entry. An index
         for the substituted pair that corresponds to empty position in the header table MUST be treated as an error.
      </p>
      <p id="rfc.section.4.3.3.p.9">This index is followed by the header value represented as a literal string as described in <a href="#string.literal.representation" title="Header Value Representation">Section&nbsp;4.1.3</a>.
      </p>
      <h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a id="parameter.negotiation" href="#parameter.negotiation">Parameter Negotiation</a></h1>
      <p id="rfc.section.5.p.1">A few parameters can be used to accommodate client and server processing and memory requirements. <span class="comment" id="rfc.comment.1">[<a href="#rfc.comment.1" class="smpl">rfc.comment.1</a>: These settings are currently not supported as they have not been integrated in the main specification. Therefore, the maximum
            buffer size for the header table is fixed at 4096 bytes.]</span> 
      </p>
      <dl>
         <dt>SETTINGS_HEADER_TABLE_SIZE (TBD):</dt>
         <dd>Allows the sender to inform the remote endpoint of the maximum size it accepts for the header table. <br> The default value is 4096 bytes. <br> <span class="comment" id="rfc.comment.2">[<a href="#rfc.comment.2" class="smpl">rfc.comment.2</a>: Is this default value OK? Do we need a maximum size? Do we want to allow infinite buffer?]</span> <br> When the remote endpoint receives a SETTINGS frame containing a SETTINGS_HEADER_TABLE_SIZE setting with a value smaller than
            the one currently in use, it MUST send as soon as possible a HEADER frame with a stream identifier of 0x0 containing a value
            smaller than or equal to the received setting value. <br> <span class="comment" id="rfc.comment.3">[<a href="#rfc.comment.3" class="smpl">rfc.comment.3</a>: This changes slightly the behaviour of the HEADERS frame, which should be updated as follows:]</span> <br> A HEADER frame with a stream identifier of 0x0 indicates that the sender has reduced the maximum size of the header table.
            The new maximum size of the header table is encoded on 32-bit. The decoder MUST reduce its own header table by dropping entries
            from it until the size of the header table is lower than or equal to the transmitted maximum size.
         </dd>
      </dl>
      <h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a>&nbsp;<a id="Security" href="#Security">Security Considerations</a></h1>
      <p id="rfc.section.6.p.1">This compressor exists to solve security issues present in stream compressors such as DEFLATE whereby the compression context
         can be efficiently probed to reveal secrets. A conformant implementation of this specification should be fairly safe against
         that kind of attack, as the reaping of any information from the compression context requires more work than guessing and verifying
         the plaintext data directly with the server. As with any secret, however, the longer the length of the secret, the more difficult
         the secret is to guess. It is inadvisable to have short cookies that are relied upon to remain secret for any duration of
         time.
      </p>
      <p id="rfc.section.6.p.2">A proper security-conscious implementation will also need to prevent timing attacks by ensuring that the amount of time it
         takes to do string comparisons is always a function of the total length of the strings, and not a function of the number of
         matched characters.
      </p>
      <p id="rfc.section.6.p.3">Another common security problem is when the remote endpoint successfully causes the local endpoint to exhaust its memory.
         This compressor attempts to deal with the most obvious ways that this could occur by limiting both the peak and the steady-state
         amount of memory consumed in the compressor state, by providing ways for the application to consume/flush the emitted headers
         in small chunks, and by considering overhead in the state size calculation. Implementors must still be careful in the creation
         of APIs to an implementation of this compressor by ensuring that header keys and values are either emitted as a stream, or
         that the compression implementation have a limit on the maximum size of a key or value. Failure to implement these kinds of
         safeguards may still result in a scenario where the local endpoint exhausts its memory.
      </p>
      <h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a>&nbsp;<a id="IANA" href="#IANA">IANA Considerations</a></h1>
      <p id="rfc.section.7.p.1">This document registers the SETTINGS_HEADER_TABLE_SIZE setting in the "HTTP/2.0 Settings" registry established by <a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2.0">[HTTP2]</cite></a>. The assigned code for this setting is TBD.
      </p>
      <h1 id="rfc.references"><a id="rfc.section.8" href="#rfc.section.8">8.</a> References
      </h1>
      <h2 id="rfc.references.1"><a href="#rfc.section.8.1" id="rfc.section.8.1">8.1</a> Normative References
      </h2>
      <table>
         <tr>
            <td class="reference"><b id="HTTP2">[HTTP2]</b></td>
            <td class="top">Belshe, M., Peon, R., Thomson, M., and A. Melnikov, “<a href="http://tools.ietf.org/html/draft-ietf-httpbis-http2-06">Hypertext Transfer Protocol version 2.0</a>”, Internet-Draft&nbsp;draft-ietf-httpbis-http2-06 (work in progress), February&nbsp;2013.
            </td>
         </tr>
      </table>
      <h2 id="rfc.references.2"><a href="#rfc.section.8.2" id="rfc.section.8.2">8.2</a> Informative References
      </h2>
      <table>
         <tr>
            <td class="reference"><b id="CRIME">[CRIME]</b></td>
            <td class="top">Rizzo, J. and T. Duong, “<a href="https://docs.google.com/a/twist.com/presentation/d/11eBmGiHbYcHR9gL5nDyZChu_-lCa2GizeuOfaLU2HOU/edit#slide=id.g1eb6c1b5_3_6">The Crime Attack</a>”, September&nbsp;2012, &lt;<a href="https://docs.google.com/a/twist.com/presentation/d/11eBmGiHbYcHR9gL5nDyZChu_-lCa2GizeuOfaLU2HOU/edit#slide=id.g1eb6c1b5_3_6">https://docs.google.com/a/twist.com/presentation/d/11eBmGiHbYcHR9gL5nDyZChu_-lCa2GizeuOfaLU2HOU/edit#slide=id.g1eb6c1b5_3_6</a>&gt;.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="PERF1">[PERF1]</b></td>
            <td class="top">Belshe, M., “<a href="http://www.ietf.org/proceedings/83/slides/slides-83-httpbis-3">IETF83: SPDY and What to Consider for HTTP/2.0</a>”, March&nbsp;2012, &lt;<a href="http://www.ietf.org/proceedings/83/slides/slides-83-httpbis-3">http://www.ietf.org/proceedings/83/slides/slides-83-httpbis-3</a>&gt;.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="PERF2">[PERF2]</b></td>
            <td class="top">McManus, P., “<a href="http://bitsup.blogspot.com/2011/09/spdy-what-i-like-about-you.html">SPDY: What I Like About You</a>”, September&nbsp;2011, &lt;<a href="http://bitsup.blogspot.com/2011/09/spdy-what-i-like-about-you.html">http://bitsup.blogspot.com/2011/09/spdy-what-i-like-about-you.html</a>&gt;.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="SPDY">[SPDY]</b></td>
            <td class="top">Belshe, M. and R. Peon, “<a href="http://tools.ietf.org/html/draft-mbelshe-httpbis-spdy">SPDY Protocol</a>”, February&nbsp;2012, &lt;<a href="http://tools.ietf.org/html/draft-mbelshe-httpbis-spdy">http://tools.ietf.org/html/draft-mbelshe-httpbis-spdy</a>&gt;.
            </td>
         </tr>
      </table>
      <div class="avoidbreak">
         <h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
         <address class="vcard"><span class="vcardline"><span class="fn">Roberto Peon</span><span class="n hidden"><span class="family-name">Peon</span><span class="given-name">Roberto</span></span></span><span class="org vcardline">Google, Inc</span><span class="vcardline">Email: <a href="mailto:fenix@google.com"><span class="email">fenix@google.com</span></a></span></address>
         <address class="vcard"><span class="vcardline"><span class="fn">Hervé Ruellan</span><span class="n hidden"><span class="family-name">Ruellan</span><span class="given-name">Hervé</span></span></span><span class="org vcardline">Canon CRF</span><span class="vcardline">Email: <a href="mailto:herve.ruellan@crf.canon.fr"><span class="email">herve.ruellan@crf.canon.fr</span></a></span></address>
      </div>
      <h1 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a>&nbsp;Change Log (to be removed by RFC Editor before publication
      </h1>
      <h2 id="rfc.section.A.1"><a href="#rfc.section.A.1">A.1</a>&nbsp;<a id="changes.since.draft-ietf-httpbis-header-compression-03" href="#changes.since.draft-ietf-httpbis-header-compression-03">Since draft-ietf-httpbis-header-compression-03</a></h2>
      <ul>
         <li>None (yet).</li>
      </ul>
      <h2 id="rfc.section.A.2"><a href="#rfc.section.A.2">A.2</a>&nbsp;Since draft-ietf-httpbis-header-compression-02
      </h2>
      <ul>
         <li>Corrected error in integer encoding pseudocode.</li>
      </ul>
      <h2 id="rfc.section.A.3"><a href="#rfc.section.A.3">A.3</a>&nbsp;Since draft-ietf-httpbis-header-compression-01
      </h2>
      <p id="rfc.section.A.3.p.1"></p>
      <ul>
         <li>Refactored of Header Encoding Section: split definitions and processing rule.</li>
         <li>Backward incompatible change: Updated reference set management as per issue #214. This changes how the interaction between
            the reference set and eviction works. This also changes the working of the reference set in some specific cases.
         </li>
         <li>Backward incompatible change: modified initial header list, as per issue #188.</li>
         <li>Added example of 32 bytes entry structure (issue #191).</li>
         <li>Added Header Set Completion section. Reflowed some text. Clarified some writing which was akward. Added text about duplicate
            header entry encoding. Clarified some language w.r.t Header Set. Changed x-my-header to mynewheader. Added text in the HeaderEmission
            section indicating that the application may also be able to free up memory more quickly. Added information in Security Considerations
            section.
         </li>
      </ul>
      <h2 id="rfc.section.A.4"><a href="#rfc.section.A.4">A.4</a>&nbsp;Since draft-ietf-httpbis-header-compression-01
      </h2>
      <p id="rfc.section.A.4.p.1"></p>
      <ul class="empty">
         <li>Fixed bug/omission in integer representation algorithm.</li>
         <li>Changed the document title.</li>
         <li>Header matching text rewritten.</li>
         <li>Changed the definition of header emission.</li>
         <li>Changed the name of the setting which dictates how much memory the compression context should use.</li>
         <li>Removed "specific use cases" section</li>
         <li>Corrected erroneous statement about what index can be contained in one byte</li>
         <li>Added descriptions of opcodes</li>
         <li>Removed security claims from introduction.</li>
      </ul>
      <h1 id="rfc.section.B"><a href="#rfc.section.B">B.</a>&nbsp;<a id="initial.headers" href="#initial.headers">Initial Header Tables</a></h1>
      <p id="rfc.section.B.p.1"><span class="comment" id="rfc.comment.4">[<a href="#rfc.comment.4" class="smpl">rfc.comment.4</a>: The tables in this section should be updated based on statistical analysis of header names frequency and specific HTTP 2.0
            header rules (like removal of some headers).]</span> <br> <span class="comment" id="rfc.comment.5">[<a href="#rfc.comment.5" class="smpl">rfc.comment.5</a>: These tables are not adapted for headers contained in PUSH_PROMISE frames. Either the tables can be merged, or the table for
            responses can be updated.]</span> 
      </p>
      <h2 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1</a>&nbsp;Requests
      </h2>
      <p id="rfc.section.B.1.p.1">The following table lists the pre-defined headers that make-up the initial header table user to represent requests sent from
         a client to a server.
      </p>
      <div id="rfc.table.1">
         <div id="initial.headers.request"></div>
         <table class="tt full center" cellpadding="3" cellspacing="0">
            <caption>Table 1: Initial Header Table for Requests</caption>
            <thead>
               <tr>
                  <th>Index</th>
                  <th>Header Name</th>
                  <th>Header Value</th>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td class="left">0</td>
                  <td class="left">:scheme</td>
                  <td class="left">http</td>
               </tr>
               <tr>
                  <td class="left">1</td>
                  <td class="left">:scheme</td>
                  <td class="left">https</td>
               </tr>
               <tr>
                  <td class="left">2</td>
                  <td class="left">:host</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">3</td>
                  <td class="left">:path</td>
                  <td class="left">/</td>
               </tr>
               <tr>
                  <td class="left">4</td>
                  <td class="left">:method</td>
                  <td class="left">GET</td>
               </tr>
               <tr>
                  <td class="left">5</td>
                  <td class="left">accept</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">6</td>
                  <td class="left">accept-charset</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">7</td>
                  <td class="left">accept-encoding</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">8</td>
                  <td class="left">accept-language</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">9</td>
                  <td class="left">cookie</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">10</td>
                  <td class="left">if-modified-since</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">11</td>
                  <td class="left">user-agent</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">12</td>
                  <td class="left">referer</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">13</td>
                  <td class="left">authorization</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">14</td>
                  <td class="left">allow</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">15</td>
                  <td class="left">cache-control</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">16</td>
                  <td class="left">connection</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">17</td>
                  <td class="left">content-length</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">18</td>
                  <td class="left">content-type</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">19</td>
                  <td class="left">date</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">20</td>
                  <td class="left">expect</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">21</td>
                  <td class="left">from</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">22</td>
                  <td class="left">if-match</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">23</td>
                  <td class="left">if-none-match</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">24</td>
                  <td class="left">if-range</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">25</td>
                  <td class="left">if-unmodified-since</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">26</td>
                  <td class="left">max-forwards</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">27</td>
                  <td class="left">proxy-authorization</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">28</td>
                  <td class="left">range</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">29</td>
                  <td class="left">via</td>
                  <td class="left"></td>
               </tr>
            </tbody>
         </table>
      </div>
      <h2 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2</a>&nbsp;Responses
      </h2>
      <p id="rfc.section.B.2.p.1">The following table lists the pre-defined headers that make-up the initial header table used to represent responses sent from
         a server to a client. The same header table is also used to represent request headers sent from a server to a client in a
         PUSH_PROMISE frame.
      </p>
      <div id="rfc.table.2">
         <div id="initial.headers.response"></div>
         <table class="tt full center" cellpadding="3" cellspacing="0">
            <caption>Table 2: Initial Header Table for Responses</caption>
            <thead>
               <tr>
                  <th>Index</th>
                  <th>Header Name</th>
                  <th>Header Value</th>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td class="left">0</td>
                  <td class="left">:status</td>
                  <td class="left">200</td>
               </tr>
               <tr>
                  <td class="left">1</td>
                  <td class="left">age</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">2</td>
                  <td class="left">cache-control</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">3</td>
                  <td class="left">content-length</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">4</td>
                  <td class="left">content-type</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">5</td>
                  <td class="left">date</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">6</td>
                  <td class="left">etag</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">7</td>
                  <td class="left">expires</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">8</td>
                  <td class="left">last-modified</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">9</td>
                  <td class="left">server</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">10</td>
                  <td class="left">set-cookie</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">11</td>
                  <td class="left">vary</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">12</td>
                  <td class="left">via</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">13</td>
                  <td class="left">access-control-allow-origin</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">14</td>
                  <td class="left">accept-ranges</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">15</td>
                  <td class="left">allow</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">16</td>
                  <td class="left">connection</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">17</td>
                  <td class="left">content-disposition</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">18</td>
                  <td class="left">content-encoding</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">19</td>
                  <td class="left">content-language</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">20</td>
                  <td class="left">content-location</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">21</td>
                  <td class="left">content-range</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">22</td>
                  <td class="left">link</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">23</td>
                  <td class="left">location</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">24</td>
                  <td class="left">proxy-authenticate</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">25</td>
                  <td class="left">refresh</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">26</td>
                  <td class="left">retry-after</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">27</td>
                  <td class="left">strict-transport-security</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">28</td>
                  <td class="left">transfer-encoding</td>
                  <td class="left"></td>
               </tr>
               <tr>
                  <td class="left">29</td>
                  <td class="left">www-authenticate</td>
                  <td class="left"></td>
               </tr>
            </tbody>
         </table>
      </div>
      <h1 id="rfc.section.C"><a href="#rfc.section.C">C.</a>&nbsp;<a id="example" href="#example">Example</a></h1>
      <p id="rfc.section.C.p.1">Here is an example that illustrates different representations and how tables are updated. <span class="comment" id="rfc.comment.6">[<a href="#rfc.comment.6" class="smpl">rfc.comment.6</a>: This section needs to be updated to better reflect the new processing of header fields, and include more examples.]</span> 
      </p>
      <h2 id="rfc.section.C.1"><a href="#rfc.section.C.1">C.1</a>&nbsp;First header set
      </h2>
      <p id="rfc.section.C.1.p.1">The first header set to represent is the following: </p>
      <div id="rfc.figure.u.5"></div><pre class="text">:path: /my-example/index.html
user-agent: my-user-agent
mynewheader: first
</pre><p> The header table is empty, all headers are represented as literal headers with indexing. The 'mynewheader' header name is
         not in the header name table and is encoded literally. This gives the following representation: 
      </p>
      <div id="rfc.figure.u.6"></div><pre class="text">0x44      (literal header with incremental indexing, name index = 3)
0x16      (header value string length = 22)
/my-example/index.html
0x4D      (literal header with incremental indexing, name index = 12)
0x0D      (header value string length = 13)
my-user-agent
0x40      (literal header with incremental indexing, new name)
0x0B      (header name string length = 11)
mynewheader
0x05      (header value string length = 5)
first
</pre><p> The header table is as follows after the processing of these headers: </p>
      <div id="rfc.figure.u.7"></div><pre class="inline">Header table
+---------+----------------+---------------------------+
|  Index  | Header Name    | Header Value              |
+---------+----------------+---------------------------+
|    0    | :scheme        | http                      |
+---------+----------------+---------------------------+
|    1    | :scheme        | https                     |
+---------+----------------+---------------------------+
|   ...   | ...            | ...                       |
+---------+----------------+---------------------------+
|   37    | warning        |                           |
+---------+----------------+---------------------------+
|   38    | :path          | /my-example/index.html    | added header
+---------+----------------+---------------------------+
|   39    | user-agent     | my-user-agent             | added header
+---------+----------------+---------------------------+
|   40    | mynewheader    | first                     | added header
+---------+----------------+---------------------------+
</pre><p> As all the headers in the first header set are indexed in the header table, all are kept in the reference set of headers,
         which is: 
      </p>
      <div id="rfc.figure.u.8"></div><pre class="inline">Reference Set:
:path, /my-example/index.html
user-agent, my-user-agent
mynewheader, first
</pre><h2 id="rfc.section.C.2"><a href="#rfc.section.C.2">C.2</a>&nbsp;Second header set
      </h2>
      <p id="rfc.section.C.2.p.1">The second header set to represent is the following: </p>
      <div id="rfc.figure.u.9"></div><pre class="text">:path: /my-example/resources/script.js
user-agent: my-user-agent
mynewheader: second
</pre><p> Comparing this second header set to the reference set, the first and third headers are from the reference set are not present
         in this second header set and must be removed. In addition, in this new set, the first and third headers have to be encoded.
         The path header is represented as a literal header with substitution indexing. The mynewheader will be represented as a literal
         header with incremental indexing. 
      </p>
      <div id="rfc.figure.u.10"></div><pre class="text">0xa6       (indexed header, index = 38: removal from reference set)
0xa8       (indexed header, index = 40: removal from reference set)
0x04       (literal header, substitution indexing, name index = 3)
0x26       (replaced entry index = 38)
0x1f       (header value string length = 31)
/my-example/resources/script.js
0x5f 0x0a  (literal header, incremental indexing, name index = 40)
0x06       (header value string length = 6)
second
</pre><p> The header table is updated as follow: </p>
      <div id="rfc.figure.u.11"></div><pre class="inline">Header table
+---------+----------------+---------------------------+
|  Index  | Header Name    | Header Value              |
+---------+----------------+---------------------------+
|    0    | :scheme        | http                      |
+---------+----------------+---------------------------+
|    1    | :scheme        | https                     |
+---------+----------------+---------------------------+
|   ...   | ...            | ...                       |
+---------+----------------+---------------------------+
|   37    | warning        |                           |
+---------+----------------+---------------------------+
|   38    | :path          | /my-example/resources/    | replaced
|         |                |     script.js             | header
+---------+----------------+---------------------------+
|   39    | user-agent     | my-user-agent             |
+---------+----------------+---------------------------+
|   40    | mynewheader    | first                     |
+---------+----------------+---------------------------+
|   41    | mynewheader    | second                    | added header
+---------+----------------+---------------------------+
</pre><p> All the headers in this second header set are indexed in the header table, therefore, all are kept in the reference set of
         headers, which becomes: 
      </p>
      <div id="rfc.figure.u.12"></div><pre class="inline">Reference Set:
:path, /my-example/resources/script.js
user-agent, my-user-agent
mynewheader, second
</pre></body>
</html>